{"ast":null,"code":"import { useReducer, useEffect, useRef, useMemo } from 'react';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar snapshotToData = function (snapshot, idField) {\n  if (!snapshot.exists) {\n    return undefined;\n  }\n\n  return __assign({}, snapshot.data(), idField ? (_a = {}, _a[idField] = snapshot.id, _a) : null);\n\n  var _a;\n};\n\nvar defaultState = function (defaultValue) {\n  return {\n    loading: defaultValue === undefined || defaultValue === null,\n    value: defaultValue\n  };\n};\n\nvar reducer = function () {\n  return function (state, action) {\n    switch (action.type) {\n      case 'error':\n        return __assign({}, state, {\n          error: action.error,\n          loading: false,\n          value: undefined\n        });\n\n      case 'reset':\n        return defaultState(action.defaultValue);\n\n      case 'value':\n        return __assign({}, state, {\n          error: undefined,\n          loading: false,\n          value: action.value\n        });\n\n      default:\n        return state;\n    }\n  };\n};\n\nvar useLoadingValue = function (getDefaultValue) {\n  var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n\n  var _a = useReducer(reducer(), defaultState(defaultValue)),\n      state = _a[0],\n      dispatch = _a[1];\n\n  var reset = function () {\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n    dispatch({\n      type: 'reset',\n      defaultValue: defaultValue\n    });\n  };\n\n  var setError = function (error) {\n    dispatch({\n      type: 'error',\n      error: error\n    });\n  };\n\n  var setValue = function (value) {\n    dispatch({\n      type: 'value',\n      value: value\n    });\n  };\n\n  return {\n    error: state.error,\n    loading: state.loading,\n    reset: reset,\n    setError: setError,\n    setValue: setValue,\n    value: state.value\n  };\n};\n\nvar useComparatorRef = function (value, isEqual, onChange) {\n  var ref = useRef(value);\n  useEffect(function () {\n    if (!isEqual(value, ref.current)) {\n      ref.current = value;\n\n      if (onChange) {\n        onChange();\n      }\n    }\n  });\n  return ref;\n};\n\nvar isEqual = function (v1, v2) {\n  var bothNull = !v1 && !v2;\n  var equal = !!v1 && !!v2 && v1.isEqual(v2);\n  return bothNull || equal;\n};\n\nvar useIsEqualRef = function (value, onChange) {\n  return useComparatorRef(value, isEqual, onChange);\n};\n\nvar useCollection = function (query, options) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsEqualRef(query, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n\n    var listener = options && options.snapshotListenOptions ? ref.current.onSnapshot(options.snapshotListenOptions, setValue, setError) : ref.current.onSnapshot(setValue, setError);\n    return function () {\n      listener();\n    };\n  }, [ref.current]);\n  return [value, loading, error];\n};\n\nvar useCollectionData = function (query, options) {\n  var idField = options ? options.idField : undefined;\n  var snapshotListenOptions = options ? options.snapshotListenOptions : undefined;\n\n  var _a = useCollection(query, {\n    snapshotListenOptions: snapshotListenOptions\n  }),\n      snapshot = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  var values = useMemo(function () {\n    return snapshot ? snapshot.docs.map(function (doc) {\n      return snapshotToData(doc, idField);\n    }) : undefined;\n  }, [snapshot, idField]);\n  return [values, loading, error];\n};\n\nvar useCollectionOnce = function (query, options) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsEqualRef(query, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n\n    ref.current.get(options ? options.getOptions : undefined).then(setValue).catch(setError);\n  }, [ref.current]);\n  return [value, loading, error];\n};\n\nvar useCollectionDataOnce = function (query, options) {\n  var idField = options ? options.idField : undefined;\n  var getOptions = options ? options.getOptions : undefined;\n\n  var _a = useCollectionOnce(query, {\n    getOptions: getOptions\n  }),\n      value = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  return [value ? value.docs.map(function (doc) {\n    return snapshotToData(doc, idField);\n  }) : undefined, loading, error];\n};\n\nvar useDocument = function (docRef, options) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsEqualRef(docRef, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n\n    var listener = options && options.snapshotListenOptions ? ref.current.onSnapshot(options.snapshotListenOptions, setValue, setError) : ref.current.onSnapshot(setValue, setError);\n    return function () {\n      listener();\n    };\n  }, [ref.current]);\n  return [value, loading, error];\n};\n\nvar useDocumentData = function (docRef, options) {\n  var idField = options ? options.idField : undefined;\n  var snapshotListenOptions = options ? options.snapshotListenOptions : undefined;\n\n  var _a = useDocument(docRef, {\n    snapshotListenOptions: snapshotListenOptions\n  }),\n      snapshot = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  var value = useMemo(function () {\n    return snapshot ? snapshotToData(snapshot, idField) : undefined;\n  }, [snapshot, idField]);\n  return [value, loading, error];\n};\n\nvar useDocumentOnce = function (docRef, options) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsEqualRef(docRef, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n\n    ref.current.get(options ? options.getOptions : undefined).then(setValue).catch(setError);\n  }, [ref.current]);\n  return [value, loading, error];\n};\n\nvar useDocumentDataOnce = function (docRef, options) {\n  var idField = options ? options.idField : undefined;\n  var getOptions = options ? options.getOptions : undefined;\n\n  var _a = useDocumentOnce(docRef, {\n    getOptions: getOptions\n  }),\n      value = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  return [value ? snapshotToData(value, idField) : undefined, loading, error];\n};\n\nexport { useCollection, useCollectionData, useCollectionOnce, useCollectionDataOnce, useDocument, useDocumentData, useDocumentOnce, useDocumentDataOnce };","map":{"version":3,"sources":["D:/GitHub/coterie/node_modules/react-firebase-hooks/firestore/dist/index.esm.js"],"names":["useReducer","useEffect","useRef","useMemo","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","snapshotToData","snapshot","idField","exists","undefined","data","_a","id","defaultState","defaultValue","loading","value","reducer","state","action","type","error","useLoadingValue","getDefaultValue","dispatch","reset","setError","setValue","useComparatorRef","isEqual","onChange","ref","current","v1","v2","bothNull","equal","useIsEqualRef","useCollection","query","options","listener","snapshotListenOptions","onSnapshot","useCollectionData","values","docs","map","doc","useCollectionOnce","get","getOptions","then","catch","useCollectionDataOnce","useDocument","docRef","useDocumentData","useDocumentOnce","useDocumentDataOnce"],"mappings":"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","sourcesContent":["import { useReducer, useEffect, useRef, useMemo } from 'react';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar snapshotToData = function (snapshot, idField) {\r\n    if (!snapshot.exists) {\r\n        return undefined;\r\n    }\r\n    return __assign({}, snapshot.data(), (idField ? (_a = {}, _a[idField] = snapshot.id, _a) : null));\r\n    var _a;\r\n};\n\nvar defaultState = function (defaultValue) {\r\n    return {\r\n        loading: defaultValue === undefined || defaultValue === null,\r\n        value: defaultValue,\r\n    };\r\n};\r\nvar reducer = function () { return function (state, action) {\r\n    switch (action.type) {\r\n        case 'error':\r\n            return __assign({}, state, { error: action.error, loading: false, value: undefined });\r\n        case 'reset':\r\n            return defaultState(action.defaultValue);\r\n        case 'value':\r\n            return __assign({}, state, { error: undefined, loading: false, value: action.value });\r\n        default:\r\n            return state;\r\n    }\r\n}; };\r\nvar useLoadingValue = (function (getDefaultValue) {\r\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\r\n    var _a = useReducer(reducer(), defaultState(defaultValue)), state = _a[0], dispatch = _a[1];\r\n    var reset = function () {\r\n        var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\r\n        dispatch({ type: 'reset', defaultValue: defaultValue });\r\n    };\r\n    var setError = function (error) {\r\n        dispatch({ type: 'error', error: error });\r\n    };\r\n    var setValue = function (value) {\r\n        dispatch({ type: 'value', value: value });\r\n    };\r\n    return {\r\n        error: state.error,\r\n        loading: state.loading,\r\n        reset: reset,\r\n        setError: setError,\r\n        setValue: setValue,\r\n        value: state.value,\r\n    };\r\n});\n\nvar useComparatorRef = function (value, isEqual, onChange) {\r\n    var ref = useRef(value);\r\n    useEffect(function () {\r\n        if (!isEqual(value, ref.current)) {\r\n            ref.current = value;\r\n            if (onChange) {\r\n                onChange();\r\n            }\r\n        }\r\n    });\r\n    return ref;\r\n};\r\nvar isEqual = function (v1, v2) {\r\n    var bothNull = !v1 && !v2;\r\n    var equal = !!v1 && !!v2 && v1.isEqual(v2);\r\n    return bothNull || equal;\r\n};\r\nvar useIsEqualRef = function (value, onChange) {\r\n    return useComparatorRef(value, isEqual, onChange);\r\n};\n\nvar useCollection = function (query, options) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsEqualRef(query, reset);\r\n    useEffect(function () {\r\n        if (!ref.current) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        var listener = options && options.snapshotListenOptions\r\n            ? ref.current.onSnapshot(options.snapshotListenOptions, setValue, setError)\r\n            : ref.current.onSnapshot(setValue, setError);\r\n        return function () {\r\n            listener();\r\n        };\r\n    }, [ref.current]);\r\n    return [value, loading, error];\r\n};\r\nvar useCollectionData = function (query, options) {\r\n    var idField = options ? options.idField : undefined;\r\n    var snapshotListenOptions = options\r\n        ? options.snapshotListenOptions\r\n        : undefined;\r\n    var _a = useCollection(query, {\r\n        snapshotListenOptions: snapshotListenOptions,\r\n    }), snapshot = _a[0], loading = _a[1], error = _a[2];\r\n    var values = useMemo(function () {\r\n        return (snapshot\r\n            ? snapshot.docs.map(function (doc) { return snapshotToData(doc, idField); })\r\n            : undefined);\r\n    }, [snapshot, idField]);\r\n    return [values, loading, error];\r\n};\n\nvar useCollectionOnce = function (query, options) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsEqualRef(query, reset);\r\n    useEffect(function () {\r\n        if (!ref.current) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        ref.current\r\n            .get(options ? options.getOptions : undefined)\r\n            .then(setValue)\r\n            .catch(setError);\r\n    }, [ref.current]);\r\n    return [value, loading, error];\r\n};\r\nvar useCollectionDataOnce = function (query, options) {\r\n    var idField = options ? options.idField : undefined;\r\n    var getOptions = options ? options.getOptions : undefined;\r\n    var _a = useCollectionOnce(query, { getOptions: getOptions }), value = _a[0], loading = _a[1], error = _a[2];\r\n    return [\r\n        (value\r\n            ? value.docs.map(function (doc) { return snapshotToData(doc, idField); })\r\n            : undefined),\r\n        loading,\r\n        error,\r\n    ];\r\n};\n\nvar useDocument = function (docRef, options) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsEqualRef(docRef, reset);\r\n    useEffect(function () {\r\n        if (!ref.current) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        var listener = options && options.snapshotListenOptions\r\n            ? ref.current.onSnapshot(options.snapshotListenOptions, setValue, setError)\r\n            : ref.current.onSnapshot(setValue, setError);\r\n        return function () {\r\n            listener();\r\n        };\r\n    }, [ref.current]);\r\n    return [value, loading, error];\r\n};\r\nvar useDocumentData = function (docRef, options) {\r\n    var idField = options ? options.idField : undefined;\r\n    var snapshotListenOptions = options\r\n        ? options.snapshotListenOptions\r\n        : undefined;\r\n    var _a = useDocument(docRef, {\r\n        snapshotListenOptions: snapshotListenOptions,\r\n    }), snapshot = _a[0], loading = _a[1], error = _a[2];\r\n    var value = useMemo(function () { return (snapshot ? snapshotToData(snapshot, idField) : undefined); }, [snapshot, idField]);\r\n    return [value, loading, error];\r\n};\n\nvar useDocumentOnce = function (docRef, options) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsEqualRef(docRef, reset);\r\n    useEffect(function () {\r\n        if (!ref.current) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        ref.current\r\n            .get(options ? options.getOptions : undefined)\r\n            .then(setValue)\r\n            .catch(setError);\r\n    }, [ref.current]);\r\n    return [value, loading, error];\r\n};\r\nvar useDocumentDataOnce = function (docRef, options) {\r\n    var idField = options ? options.idField : undefined;\r\n    var getOptions = options ? options.getOptions : undefined;\r\n    var _a = useDocumentOnce(docRef, { getOptions: getOptions }), value = _a[0], loading = _a[1], error = _a[2];\r\n    return [\r\n        (value ? snapshotToData(value, idField) : undefined),\r\n        loading,\r\n        error,\r\n    ];\r\n};\n\nexport { useCollection, useCollectionData, useCollectionOnce, useCollectionDataOnce, useDocument, useDocumentData, useDocumentOnce, useDocumentDataOnce };\n"]},"metadata":{},"sourceType":"module"}